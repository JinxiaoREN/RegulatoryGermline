name: SomaticWrapper
description: Run somaticwrapper on the TCGA WGS data

inputParameters:
- name: sample
- name: config
  localCopy:
    disk: datadisk
    path: input/gen_config.sh
- name: fasta
  localCopy:
    disk: datadisk
    path: input/Homo_sapiens_assembly19.fasta
- name: faidx
  localCopy:
    disk: datadisk
    path: input/Homo_sapiens_assembly19.fasta.fai
- name: dict
  localCopy:
    disk: datadisk
    path: input/Homo_sapiens_assembly19.dict
- name: dbsnp
  localCopy:
    disk: datadisk
    path: input/00-All.brief.pass.cosmic.vcf
- name: normal_bam
  localCopy:
    disk: datadisk
    path: input/normal.bam
- name: normal_bai
  localCopy:
    disk: datadisk
    path: input/normal.bam.bai
- name: tumor_bam
  localCopy:
    disk: datadisk
    path: input/tumor.bam
- name: tumor_bai
  localCopy:
    disk: datadisk
    path: input/tumor.bam.bai

outputParameters:
- name: output_path
  localCopy:
    disk: datadisk
    path: output/*

resources:
  minimumCpuCores: 1
  minimumRamGb: 8
  zones:
  - us-central1-a
  - us-central1-b
  - us-central1-c
  - us-central1-f
  disks:
  - name: datadisk
    type: PERSISTENT_HDD
    sizeGb: 1500
    mountPoint: /mnt/data

docker:
  imageName: scao/somaticwrapper
  cmd: >
    mkdir /mnt/data/output &&
    bash /mnt/data/input/gen_config.sh ${tumor_bam} ${normal_bam} output > sw.config &&
    perl SomaticWrapper.pl /mnt/data 0 sw.config
